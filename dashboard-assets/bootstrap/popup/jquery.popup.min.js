/** jQuery plugin 'popup' v.1.0.0 | Copyright (Â©) by Konstantin Kachurenko <konstantin.kachurenko@gmail.com> | http://konstantin-kachurenko.github.io | The MIT License (MIT) http://opensource.org/licenses/MIT */
(function($){"use strict";function _overlay(){!this.options.modal&&this.close();}function _close(){this.$popup.add(this.$overlay).removeClass('popup-show');}$.popup=function(element,options){var $both;this.$popup=$(element).addClass('popup');if(this.$popup.data('popup')instanceof $.popup){this.$popup.data('popup').destroy();}this.config(options);this.$overlay=$(this.$popup.next('.popup-overlay').get(0)||'<div class="popup-overlay" data-popup-js="" />').insertAfter(this.$popup);$both=this.$popup.add(this.$overlay).data('popup',this);options.bubble&&$('body').append($both);this.$overlay.on('click',$.proxy(_overlay,this));this._realign=(function(plugin){return function(){plugin.realign();};})(this);$(window).on('resize',this._realign);};$.popup.prototype.defaultOptions={modal:false,bubble:true,open:function(){},close:function(){},realign:function(){}};$.popup.prototype.options={};$.popup.prototype.$popup=null;$.popup.prototype.$overlay=null;$.popup.prototype.config=function(options){this.options=$.extend({},this.defaultOptions,this.options,options);return this;};$.popup.prototype.overlay=function(){if(!this.$overlay.hasClass('popup-show')){$('.popup.popup-show').after(this.$overlay);this.$overlay.addClass('popup-show');}return this;};$.popup.prototype.open=function(){this.options.open instanceof Function&&this.options.open.call(this.$popup.get(0));this.overlay().$overlay.after(this.$popup);this.realign().$popup.addClass('popup-show');return this;};$.popup.prototype.realign=function(){var realign=this.options.realign;realign instanceof Function&&realign.call(this.$popup.get(0));this.$popup.css({'margin-top':'-'+(this.$popup.outerHeight(false)/2)+'px','margin-left':'-'+(this.$popup.outerWidth(false)/2)+'px'});return this;};$.popup.prototype.close=function(delay){if(delay!==void 0){setTimeout($.proxy(this.close,this),Math.abs(Number(delay))|0);}else{this.options.close instanceof Function&&this.options.close.call(this.$popup.get(0));_close.call(this);}return this;};$.popup.prototype.destroy=function(){_close.call(this);$(window).off('resize',this._realign);this.$overlay.off('click',$.proxy(_overlay,this));this.$popup.add(this.$overlay).removeData('popup').filter('[data-popup-js]').remove();return this.$popup;};$.fn.popup=function(options){return this.each(function(i,elem){(new $.popup(elem,options===void 0?{}:options));});};$(document).on('click','.popup-close',function(e){var $popup=$(e.target).closest('.popup, .popup-overlay').eq(0);e.preventDefault();if($popup.length){if($popup.data('popup')instanceof $.popup){$popup.data('popup').close();}}});})(jQuery);